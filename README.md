# アプリ名

sachiale・・・冷蔵庫の中には残り物が沢山ある事と、「残り物には福がある」ということわざから、ユーザーに「幸あれ」という思いからこのアプリ名にしました。

# 概要

sachialeは冷蔵庫の在庫管理アプリです。アプリを利用するにはユーザー登録が必要となります。ユーザーは購入した食材の情報を登録することで、食材一覧ページに賞味期限が近いものから順に一覧で表示されます。さらに購入予定の食材を登録することで買い物リストを作成することもできます。
そしてユーザーはシェアしたいレシピを投稿することで、トップページにおいて投稿したレシピが全てのユーザーに一覧表示されます。

# 本番環境

### 接続先情報
#### URL
https://sachiale.herokuapp.com/
- Herokuでデプロイしているため、Herokuの仕様により本番環境にアクセス頂いた際に画像リンクが切れている可能性がございます。

#### テストアカウント
- メールアドレス：test@com
- パスワード：aaa111


# 利用方法(DEMO)

## トップページ(レシピ一覧表示画面)
[![Image from Gyazo](https://i.gyazo.com/052b94baeb252cb6c0c5a31e0d0a7de3.gif)](https://gyazo.com/052b94baeb252cb6c0c5a31e0d0a7de3)

(https://sachiale.herokuapp.com/)にアクセスするとトップページが表示されます。
トップページには、アプリの概要、マイページの説明、投稿されたレシピ一覧が表示されています。
レシピ一覧にはレシピの写真とレシピ名が表示されています。

## ユーザー新規登録、ログインページ
[![Image from Gyazo](https://i.gyazo.com/f6f7e98a01430e2fb44afce3a50ca97b.png)](https://gyazo.com/f6f7e98a01430e2fb44afce3a50ca97b)

ユーザー新規登録では、ニックネーム、email、パスワード、生年月日の入力が必須となります。
`ユーザー登録`ボタンを押す事で登録できます。登録後はトップページに遷移します。

[![Image from Gyazo](https://i.gyazo.com/956dade4efa77e40a2d8940fabde6778.png)](https://gyazo.com/956dade4efa77e40a2d8940fabde6778)

ログインでは、emailとパスワードの入力が必須となります。`ログイン`ボタンを押す事でログインできます。ログイン後はトップページに遷移します。

## レシピ投稿ページ、編集ページ
[![Image from Gyazo](https://i.gyazo.com/515bae2e6b5cf5c239f6acd60d554743.png)](https://gyazo.com/515bae2e6b5cf5c239f6acd60d554743)

レシピ投稿ページではレシピの画像一枚、レシピ名、レシピの説明、かかった食費の入力が必須となります。トップページの`投稿する`ボタンを押す事でレシピが投稿できます。
投稿できるとトップページに遷移します。

[![Image from Gyazo](https://i.gyazo.com/d17182c23c2990737e955c2de1b90999.png)](https://gyazo.com/d17182c23c2990737e955c2de1b90999)

レシピ編集ページは基本的にレシピ投稿ページのフォームと同じです。
ですが編集ページは既に投稿されていた画像以外の投稿内容が入力された状態で表示されます。

何も変更を加えずに`変更する`ボタンを押しても画像が無くなった状態にはなりません。
変更後はトップページに遷移します。

## レシピ詳細ページ
[![Image from Gyazo](https://i.gyazo.com/4255f17983dbba62ca8139850a892609.gif)](https://gyazo.com/4255f17983dbba62ca8139850a892609)

レシピ詳細ページには投稿者名、レシピにかかる食費、材料、レシピの説明が表示されています。

下部にはコメント欄があり、ログインしたユーザーであればレシピに対するコメントを投稿できます。

レシピを投稿したユーザーだけには、`レシピの編集`ボタンと`削除`ボタンが表示されています。

## 食材一覧ページ
[![Image from Gyazo](https://i.gyazo.com/d519eb4cef1267ccaefc61f6651c8044.gif)](https://gyazo.com/d519eb4cef1267ccaefc61f6651c8044)

トップページ中部の`サービス概要`もしくは`マイページ`のアイコンから食材一覧ページに遷移する事ができます。食材一覧ページには自分が補充した食材が賞味期限が近い順に表示されています。リストには食材の画像、食材名、賞味期限、残り数量が表示されています。

リストの上部には食材検索フォームがあり、食材名やカテゴリーを選択することで簡単に補充済みの食材を検索する事ができます。

食材リストをクリックすると食材詳細ページに、`アイテム追加`ボタンからは食材補充ページに、`買い物リスト`ボタンからは買い物リスト一覧ページに遷移する事ができます。

## 食材補充ページ、編集ページ
[![Image from Gyazo](https://i.gyazo.com/e36c13963b3c89b38af02f8ab567b048.gif)](https://gyazo.com/e36c13963b3c89b38af02f8ab567b048)

食材補充ページでは、食材の画像一枚、食材名、補充数量、賞味期限、カテゴリーが必須で入力が必要となります。
メモと各カテゴリーでの食材選択は任意入力となります。
`補充する`ボタンより食材の補充ができます。
補充後は食材一覧ページに遷移します。

各カテゴリーの食材選択フォームは、カテゴリーの選択によって表示内容を変更するように実装する予定でしたが、思うような挙動にならず、現在は全てのフォームを表示している状態です。
今後、修正をしようと考えています。


[![Image from Gyazo](https://i.gyazo.com/64fcffc202dc032b39f44a2bf97d45ef.gif)](https://gyazo.com/64fcffc202dc032b39f44a2bf97d45ef)

食材編集ページは基本的に食材補充ページと同じフォームです。
編入ページの場合、既に補充されていた画像以外の食材情報がフォームに入力された状態で表示されます。
何も変更を加えず`変更する`ボタンを押しても画像が無くなった状態にはなりません。
変更後は食材一覧ページに遷移します。

## 食材詳細ページ
[![Image from Gyazo](https://i.gyazo.com/cc83b6b59f8adedc3bfed531232196ef.gif)](https://gyazo.com/cc83b6b59f8adedc3bfed531232196ef)

食材一覧ページのリストをクリックすると食材詳細ページに遷移できます。食材詳細ページでは、補充してある食材の画像、食品名、メモ、保存数量、賞味期限、カテゴリーが表示されます。

食材を補充したユーザーだけには、`食材の編集`ボタンと`削除`ボタンが表示されています。

## 買い物リスト一覧ページ
[![Image from Gyazo](https://i.gyazo.com/3aea36b818958bf67ef0174bcbe410a2.gif)](https://gyazo.com/3aea36b818958bf67ef0174bcbe410a2)

食材一覧ページの`買い物リスト`ボタンから買い物リスト一覧ページに遷移できます。買い物リスト一覧ページには、買い物リストに追加した食材が表示されています。
リストには、食品名、買う予定の数量、メモが表示されます。

各リストの右端に`編集`ボタンと`削除`ボタンがあり、そこから買い物リスト編集ページへの遷移と、買い物リストの削除が行えます。

`追加`ボタンから買い物リスト追加ページへ遷移する事ができます。

## 買い物リスト追加ページ、編集ページ
[![Image from Gyazo](https://i.gyazo.com/2b0369864a87a27ae0be1a5b9298597a.png)](https://gyazo.com/2b0369864a87a27ae0be1a5b9298597a)

買い物リスト追加ページでは、食材名だけが必須入力事項となります。メモ、買う予定の数量は任意で入力できます。
`追加する`ボタンを押す事で買い物リストに食材を追加する事ができます。
追加すると、買い物リスト一覧に遷移します。


[![Image from Gyazo](https://i.gyazo.com/26b20e0f87ff3e553f5828020bfddfd0.png)](https://gyazo.com/26b20e0f87ff3e553f5828020bfddfd0)

買い物リスト編集ページは基本的に買い物リスト追加ページと同じです。
編集ページは既に追加されていた内容がフォームに入力された状態で表示されます。
`変更する`ボタンを押すと内容を変更する事ができます。
変更後は、買い物リスト一覧に遷移します。


# 制作背景(意図)

アプリを作ろうと思ったのは実家の冷蔵庫がもので溢れていた事がきっかけでした。誰がいつ買ったものか分からないものが冷蔵庫の奥底から出てくることは日常茶飯事でしたし、賞味期限が切れており、料理に使えず捨てるしかない食材が出てしまう事がとても勿体無く感じていました。
私自身料理をする機会もあり、冷蔵庫が整理されていないことに不快感を感じることが多かったので冷蔵庫の在庫管理アプリを作成することに決めました。
ペルソナの設定は、一般的に冷蔵庫内の内容から献立を考えることの多い30~50代の主婦(夫)。家事をする時間のある人が対象なので、職業はフルタイムではなくパート勤務の方を対象にしました。
食材を賞味期限を切らすことなく使い切れることを目標にしたアプリなので、ユーザーが抱えている食材が使われているレシピをピックアップする機能も追加で実装しようと考えています。

# 洗い出した要件

### 機能：ユーザー管理機能
- 優先順位（高：3、中：2、低：1）：３
- 目的：ユーザー管理をする事でその他機能の管理をやりやすくします。
- 詳細：deviceを利用して、ユーザー新規登録、ログイン機能、ログアウト機能を実装します。
- ストーリー：新規登録はニックネーム、email、password、誕生日を入力すると登録でき、ログインでは、emailとpasswordを入力すればログインできます。
- 見積もり時間：3

### 機能：食材補充機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：購入した食材を補充(データベースに保存)する事で、食材管理アプリを実装します。
- 詳細：写真を1枚添付、食材名、カテゴリー、賞味期限、数量、メモを入力することで保存する事ができます。
- ストーリー：写真、食材名、カテゴリー、賞味期限、数量は必須で入力、メモは任意入力でデータを保存できます。
- 見積もり時間：4

### 機能：食材一覧表示機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：補充した食材を一目で確認できます。
- 詳細：マイページに遷移することで食材一覧を見る事ができる。一覧表示には食材名、写真、賞味期限が表示される様にします。
- ストーリー：ユーザーは自分が保存した食材を一覧で見る事ができる。表示される順番は上部から賞味期限が近い食材を順に表示している。スクロールする事で全ての食材を閲覧できます。
- 見積もり時間：3

### 機能：食材編集機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：使用した食材の残りの分量などを管理します。
- 詳細：食材詳細ページの編集ボタンから編集ページに遷移できます。使用して分量が減ってしまった材料の情報修正などをします。
- ストーリー：食材を追加したユーザーだけが食材の画像、食材名、分量、メモ、数量、賞味期限、カテゴリーを変更できます。
- 見積もり時間：3

### 機能：食材削除機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：料理に使い切った食材の項目を削除できます。
- 詳細：食材詳細ページの削除ボタンから食材を削除する事ができます。使い切った材料を削除できます。
- ストーリー：食材を追加したユーザーだけが使い切った食材を食材詳細ページから削除ボタンで削除できます。
- 見積もり時間：3

### 機能：食材検索機能
- 優先順位（高：3、中：2、低：1）：２
- 目的：特定の食材の詳細を素早く確認できます。
- 詳細：食材一覧ページの検索フォームの食材の名前、カテゴリーを選択することで、特定の食材をすぐに見つける事ができます。
- ストーリー：ユーザーはプルダウンで表示される選択肢を選ぶと、それに該当する食材が検索結果ページにて表示されます。選択肢は食材名、カテゴリーの2つです。
- 見積もり時間：4

### 機能：食材詳細表示機能
- 優先順位（高：3、中：2、低：1）：３
- 目的：食材についての詳細を確認できます。
- 詳細：食材一覧ページの食材リストをクリックすると食品詳細ページに遷移できます。保存した食材の食材名、メモ、数量、賞味期限、カテゴリーを表示します。
- ストーリー：食材を補充したユーザーのみ食材詳細ページに遷移できます。編集ボタン、削除ボタンがあります。
- 見積もり時間：３

### 機能：レシピ投稿機能
- 優先順位（高：3、中：2、低：1）：３
- 目的：おすすめ料理を他のユーザーにシェアできます。
- 詳細：レシピ投稿ページより料理名、写真1枚、説明、食材、食費を入力するとレシピを投稿できます。
- ストーリー：ユーザーはトップページの投稿ボタンよりレシピ投稿ページに遷移できます。料理名、写真1枚、説明、食材、食費は必須入力です。説明の部分に料理手順を記入します。
- 見積もり時間：4

### 機能：レシピ一覧表示機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：ユーザーが投稿した献立を一目で確認できます。
- 詳細：トップページ下部がレシピ一覧となります。レシピ一覧には料理名、写真が表示される様にします。
- ストーリー：ユーザーはログインの有無に関わらずレシピ一覧を見る事ができます。表示される順番は、上部から最新投稿順に表示されます。
- 見積もり時間：5

### 機能：レシピ編集機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：投稿した献立の内容を変更できます。
- 詳細：レシピ詳細ページの編集ボタンからレシピ編集ページに遷移できます。画像以外の投稿内容は入力済みの状態で表示されます。
- ストーリー：レシピを投稿したユーザーのみレシピを編集できます。レシピの編集は編集画面に遷移します。何も記入せずに変更ボタンを押しても投稿がなくなったりはしません。
- 見積もり時間：3

### 機能：レシピ削除機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：投稿した献立を削除できます。
- 詳細：レシピ詳細ページの削除ボタンより投稿したレシピを削除する事ができます。
- ストーリー：レシピを投稿したユーザーのみレシピ詳細ページにある削除ボタンより削除できます。
- 見積もり時間：2

### 機能：レシピ詳細表示機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：気になる献立の詳細情報を閲覧できます。
- 詳細：レシピ一覧表示されているレシピをクリックすることでレシピ詳細ページに遷移できます。レシピ詳細表示では、一覧では表示されていない食材、料理の説明、投稿したユーザーのニックネームも表示されています。
- ストーリー：ログインの有無に関わらずレシピ詳細ページに遷移できます。このページの下部にコメント欄があります。
- 見積もり時間：3

### 機能：買い物リスト追加機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：買う必要のある食材などをリストにまとめる事ができます。
- 詳細：買い物リスト一覧の追加ボタンから買い物リスト追加ページに遷移できます。食材名、メモ、数量を入力する事でリストに追加できます。
- ストーリー：ユーザーは食材名を必須入力とし、メモ、数量は任意入力で買い物リストに保存できます。
- 見積もり時間：3

### 機能：買い物リスト編集機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：買う必要のある食材などの変更ができます。
- 詳細：買い物一覧ページの編集ボタンより買い物リスト編集ページに遷移できます。買い物リストに追加した食材の名前、数量、メモを変更できます。
- ストーリー：買い物リストを追加したユーザーのみ買い物リストを編集できます。
- 見積もり時間：3

### 機能：買い物リスト削除機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：買い物リストに追加したものを削除できます。
- 詳細：買い物リストに追加した食材を削除ボタンで削除できます。
- ストーリー：商品購入後や必要ではなくなった場合に削除ボタンから削除できます。
- 見積もり時間：2

### 機能：周辺地図検索機能
- 優先順位（高：3、中：2、低：1）：１
- 目的：現在いる場所周辺のスーパーやコンビニなどを検索できます。
- 詳細：Googleマップを利用して、現在地の近くにあるスーパーやコンビニを表示させます。
- ストーリー：Google Maps JavaScript APIを利用して実装したいと考えています。
- 見積もり時間：10

### 機能：コメント機能
- 優先順位（高：3、中：2、低：1）：２
- 目的：投稿されているレシピについてユーザー同士で意見交換ができます。
- 詳細：レシピ詳細ページの下部にコメント欄があります。ログインしているユーザーに限りコメントが投稿できます。
- ストーリー：ログインしているユーザーに限りフォームにコメントを入力し、送信ボタンを押すとコメントが送信されます。
- 見積もり時間：4

### 機能：パンくずリスト機能
- 優先順位（高：3、中：2、低：1）：２
- 目的：ユーザーがサイト内で迷子にならないようにします。
- 詳細：トップページから各ページに遷移すると、各ページ上部に画面遷移の記録が表示されます。
- ストーリー：ユーザーはパンくずリストがあることで、遷移してきた過去のページに遷移することもできます。
- 見積もり時間：2

### 機能：買い物リスト一覧表示機能
- 優先順位（高：3、中：2、低：1）：3
- 目的：買い物リストに追加した食材が一覧で表示されています。
- 詳細：食材一覧ページの買い物リストボタンより買い物リスト一覧ページに遷移できます。買う予定の食材名、数量、メモが表示されており、編集ボタン、削除ボタンがあります。
- ストーリー：ログインしたユーザーのみ買い物リスト一覧ページに遷移できます。追加ボタンより追加された食材が一覧で表示されています。
- 見積もり時間：3

### 機能：レシピ検索機能
- 優先順位（高：3、中：2、低：1）：１
- 目的：ユーザーが求めるレシピを探しやすくなります。
- 詳細：レシピ一覧ページ(トップページ)にある検索フォームの食材を選択することでその食材を含むレシピを検索結果として表示します。
- ストーリー：ログインの有無に関わらずレシピ検索する事ができます。
- 見積もり時間：6



# 工夫したポイント

食材一覧と買い物リストに関しては、コントローラー内のアクションにカレントユーザーに紐づいたデータだけを渡すことで、そのユーザーだけの食材と買い物リストが表示されるようにしました。

レシピ一覧、食材一覧、買い物リスト一覧のそれぞれの背景を変えることで、視覚的に今なんのデータが表示されているのかを分かりやすくしました。

# 使用技術(開発環境)

## バックエンド

Ruby, Ruby on Rails

## フロントエンド

HTML, CSS, JavaScript, Jquery

## データベース

MySQL, SequelPro

## 本番環境

Heroku

## ソース管理

GitHub, GitHubDesktop

## テスト

RSpec

## エディタ

VSCode

# 課題や今後実装したい機能

要件には定義していますが、マップを利用した現在地周辺のスーパー検索機能と、レシピ検索機能が実装できていません。是非導入したい機能ではありましたが、自分の技術力と開発期限を考えた時に優先順位を落とさざるを得ませんでした。
今後はこの二つの機能を優先的に追加実装して行きたいと考えています。

課題としては、食材補充ページの食材選択フォームが全て表示されてしまっているので、カテゴリー選択によって表示が変わるように修正をしなければならないことと、レシピ投稿の際に使用する食材を選択できるようにすることです。

# テーブル設計

## Users テーブル

| Column                      | Type         | Options                   |
| --------------------------- | ------------ | ------------------------- |
| nickname                    | string       | null: false               |
| email                       | string       | null: false, unique: true |
| encrypted_password          | string       | null: false               |
| birthday                    | date         | null: false               |

### Association

- has_many :items
- has_many :comments
- has_many :blogs
- has_one  :buy_lists

## Items テーブル

| Column                      | Type         | Options                        |
| --------------------------- | ------------ | ------------------------------ |
| item_name                   | string       | null: false                    |
| memo                        | text         |                                |
| category_id                 | integer      | null: false                    |
| amount                      | integer      | null: false                    |
| open_date                   | date         | null: false                    |
| user                        | references   | null: false, foreign_key: true |

### Association

- belongs_to :user
- has_many :blogs, through::blog_items

## Blogs テーブル

| Column                      | Type         | Options                        |
| --------------------------- | ------------ | ------------------------------ |
| recipe_name                 | string       | null: false                    |
| explain                     | text         | null: false                    |
| price                       | integer      | null: false                    |
| user                        | references   | null: false, foreign_key: true |

### Association

- belongs_to :user
- has_many :items, through::blog_items
- has many :comments

## Blog_items テーブル

| Column                      | Type         | Options                        |
| --------------------------- | ------------ | ------------------------------ |
| blog                        | references   | null :false, foreign_key: true |
| item                        | references   | null :false, foreign_key: true |

### Association

- belongs_to :user
- belongs_to :item

## Comments テーブル

| Column                      | Type         | Options                        |
| --------------------------- | ------------ | ------------------------------ |
| text                        | text         | null: false                    |
| blog                        | references   | null: false, foreign_key: true |
| user                        | references   | null: false, foreign_key: true |

### Association

- belongs_to :user
- belongs_to :blog

## Buy_lists テーブル

| Column                      | Type         | Options                        |
| --------------------------- | ------------ | ------------------------------ |
| item_name                   | string       | null: false                    |
| buy_memo                    | text         |                                |
| amount                      | integer      |                                |
| user                        | references   | null: false, foreign_key: true |

### Association

- belongs_to :user

# ローカルでの動作方法

### 以下のコマンドを順にターミナルで実行してください

```
% git clone https://git.heroku.com/sachiale.git
% cd sachiale
% bundle install
% yarn install
% rails db:create
% rails db:migrate
% rails s
```

- このアプリケーションはmacOS Big Sur 11.3にインストールしたRuby 2.6.5、rails 6.0.0を使用しています。